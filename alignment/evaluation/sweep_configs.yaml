# Sweep configurations for classify_reward_cost_unified.py
# Each entry will be run as a separate SLURM array job

# Common settings (can be overridden per-sweep)
defaults:
  dataset_name: PKU-Alignment/PKU-SafeRLHF
  split: test
  policy_max_new_tokens: 512
  policy_temperature: 0.0
  reward_model: PKU-Alignment/beaver-7b-unified-reward
  cost_model: PKU-Alignment/beaver-7b-unified-cost
  num_samples: 3036
  bf16: true
  policy_use_vllm: true

sweeps:
  # # ============ ES Fine-tuned checkpoints ============
  # - model_name: ES-100
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251104_160009/model_saves/tmp_iter_100.pth
  #   output_dir: alignment/results
  
  - model_name: ES-repro-n50
    policy_model_path: PKU-Alignment/alpaca-7b-reproduced
    policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251210_002807_917048_50122327/model_saves/tmp_iter_1000.pth
    output_dir: alignment/results-fixed

  - model_name: ES-repro
    policy_model_path: PKU-Alignment/alpaca-7b-reproduced
    policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251210_002807_956518_50122388/model_saves/tmp_iter_1000.pth
    output_dir: alignment/results-fixed

  # # ============ ES Fine-tuned  ============
  # - model_name: ES-500-f_nmtt_n50
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251202_205024/model_saves/tmp_iter_500.pth
  #   output_dir: alignment/results-fixed

  # - model_name: ES-500-f-nmt
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251202_092048/model_saves/tmp_iter_500.pth
  #   output_dir: alignment/results-fixed

  # - model_name: ES-1000-n50
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095932/model_saves/tmp_iter_1000.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_1000.pth
  #   output_dir: alignment/results

    # - model_name: ES-1000-n50
    # policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
    # policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095932/model_saves/tmp_iter_1000.pth
    # output_dir: alignment/results

  # - model_name: ES-1000-n250-iter100
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_100.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter200
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_200.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter300
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_300.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter400
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_400.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter500
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_500.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter600
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_600.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter700
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_700.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter800
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_800.pth
  #   output_dir: alignment/results

  # - model_name: ES-1000-n250-iter900
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
  #   policy_vllm_ckpt: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/es-ft-experiment/alignment_nccl_20251205_095805/model_saves/tmp_iter_900.pth
  #   output_dir: alignment/results

  # # ============ GRPO checkpoints ============
  # - model_name: GRPO-beta0.001-f
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.001_seed42_fixed/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.01-f
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.01_seed42_fixed/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.1-f
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_fixed/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta1.0-f
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta1.0_seed42_fixed/checkpoint-500/
  #   output_dir: alignment/results-fixed

  - model_name: GRPO-beta0.01
    policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified_repro_n250/beta0.01_seed42
    output_dir: alignment/results-fixed

  - model_name: GRPO-beta0.05
    policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified_repro_n250/beta0.05_seed42
    output_dir: alignment/results-fixed

  - model_name: GRPO-beta0.1
    policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified_repro_n250/beta0.1_seed42
    output_dir: alignment/results-fixed

  - model_name: GRPO-beta0.15
    policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified_repro_n250/beta0.15_seed42
    output_dir: alignment/results-fixed
  

  # # ============ GRPO No Multiturn checkpoints ============
  # - model_name: GRPO-beta0.001-f_nmtt
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.001_seed42_fixed_no_multiturn/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.01-f_nmtt
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.01_seed42_fixed_no_multiturn/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.1-f_nmtt
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_fixed_no_multiturn/checkpoint-500/
  #   output_dir: alignment/results-fixed_no_multiturn

  # - model_name: GRPO-beta1.0-f_nmtt
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta1.0_seed42_fixed_no_multiturn/checkpoint-500/
  #   output_dir: alignment/results-fixed_no_multiturn
  # # # ============ Baseline models ============
  - model_name: Alpaca-7b
    policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/models/alpaca-7b
    output_dir: alignment/results

  - model_name: Beaver-V1
    policy_model_path: PKU-Alignment/beaver-7b-v1.0
    output_dir: alignment/results

  - model_name: Beaver-V2
    policy_model_path: PKU-Alignment/beaver-7b-v2.0
    output_dir: alignment/results

  - model_name: Beaver-V3
    policy_model_path: PKU-Alignment/beaver-7b-v3.0
    output_dir: alignment/results

  # # ============ GRPO per device batch size  checkpoints ============

  # - model_name: GRPO-beta0.1-f-nmt-pdbs4
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_fixed_no_multiturn_pdbs4/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # # # ============ GRPO unified checkpoints ============

  # - model_name: GRPO-beta0.01-f_unified
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.01_seed42_fixed_unified/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.1-f_unified
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_fixed_unified/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.01-f
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified/beta0.01_seed42/checkpoint-500/
  #   output_dir: alignment/results

  # - model_name: GRPO-beta0.01-n50
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/unified_n50/beta0.01_seed42/checkpoint-500/
  #   output_dir: alignment/results

  # # ============ GRPO unified not fixed checkpoints ============

  # - model_name: GRPO-beta0.01-unified
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.01_seed42_unified/checkpoint-500/
  #   output_dir: alignment/outputs/model_comparisons

  # - model_name: GRPO-beta0.1-unified
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_unified/checkpoint-500/
  #   output_dir: alignment/outputs/model_comparisons


  # # # ============ GRPO no multiturn n=50 checkpoints ============

  # - model_name: GRPO-beta0.01-f_nmtt_n50
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.01_seed42_fixed_no_multiturn_50/checkpoint-500/
  #   output_dir: alignment/results-fixed

  # - model_name: GRPO-beta0.1-f_nmtt_n50
  #   policy_model_path: /n/netscratch/kempner_sham_lab/Lab/itamarf/es-fine-tuning-paper/alignment/GRPO_output/beta0.1_seed42_fixed_no_multiturn_50/checkpoint-500/
  #   output_dir: alignment/results-fixed